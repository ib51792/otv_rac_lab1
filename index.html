 <!DOCTYPE html>
 <html lang="en">

 <head>
 	<meta charset="UTF-8">
	 <meta author="Ivan Bukovac">
	 <meta license="Creative Commons Zero v1.0 Universal">
	 <meta jezik="hrvatski">
	 <meta discription="nazivSerije - navodi ime serije
	 ocjenaIMDB - navodi ocjenu serije na stranici https://www.imdb.com
	 zanr - navodi sve žanrove u koje serija pripada
	 redatelj - navodi ime, prezime te wikipedia stranica redatelja serije
	 glumci - navodi par glavnih glumaca serije, njihovo ime, prezime i wikipedia stranica
	 wikipediaStranicaSerije - navodi link na wikipediu stranicu serije
	 brojSezona - navodi trenutni broj sezona serije
	 godinaSnimanja - navodi razdoblje snimanja serije u godinama
	 infoSerije - navodi glavnu temu serije
	 urlPostera - navodi url slike postera serije">
 	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
 	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
 	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
 	<title>Lab2 OR</title>
 </head>
 <style>
 	.dropbtn {
 		background-color: #3498DB;
 		color: white;
 		padding: 16px;
 		font-size: 16px;
 		border: none;
 		cursor: pointer;
 	}

 	.dropbtn:hover,
 	.dropbtn:focus {
 		background-color: #2980B9;
 	}

 	.dropdown {
 		position: relative;
 		display: inline-block;
 	}

 	.dropdown-content {
 		display: none;
 		position: absolute;
 		background-color: #f1f1f1;
 		min-width: 160px;
 		overflow: auto;
 		box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
 		z-index: 1;
 	}

 	.dropdown-content a {
 		color: black;
 		padding: 12px 16px;
 		text-decoration: none;
 		display: block;
 	}

 	.dropdown a:hover {
 		background-color: #ddd;
 	}

 	.show {
 		display: block;
 	}
 </style>

 <body>
 	<div class="container" style="padding:50px 250px;">
 		<h1>Live Search</h1>
 		<form role="form">
 			<div class="form-group">
 				<input type="input" class="form-control input-lg" id="txt-search"
 					placeholder="Type your search character">
 		</form>
 		<div id="filter-records"></div>
 	</div>
 	<div class="dropdown">
 		<button onclick="myFunction()" class="dropbtn">Traži...</button>
 		<div id="myDropdown" class="dropdown-content">
 			<a href="#wild" id="wild">
 				po svemu</a>
	  <a  id="imeGlumac">Ime glumca</a>
	  <a  id="prezimeGlumac">Prezime glumca</a>
	  <a  id="imeRedatelj">Ime redatelja</a>
	  <a  id="prezimeRedatelj">Prezime redatelja</a>
	  <a  id="nazivSerije">Naziv serije</a>
	</div>
	<div class="dropdown">
 		<button onclick="myFunction2()" class="dropbtn">Download</button>
 		<div id="myDropdown2" class="dropdown-content">
	  <a href="#" id="downloadAnchorElem" >JSON</a>
	  <a href="#" id="da" download>CSV</a>
	</div>
	<div class="dropdown">
		<button onclick="myFunction3()" class="dropbtn">Download original</button>
		<div id="myDropdown3" class="dropdown-content">
	 <a href="tv_serije.json"  download>JSON</a>
	 <a href="tv_serije.csv"  download>CSV</a>
   </div>
  </div>
</body>
</html>
<script type="text/javascript">

var data = [{
  "_id": {
    "$oid": "5f97108173c2c22ef41f44e8"
  },
  "nazivSerije": "12 Monkeys",
  "ocjenaIMDb": 7.7,
  "zanr": [
    "Avantura",
    "Drama",
    "Misterij"
  ],
  "redatelj": {
    "imeRedatelj": "Travis",
    "prezimeRedatelj" : "Fickett",
    "wikipediaStranicaRedatelja": "Travis_Fickett"
  },
  "glumci": [
    {
      "imeGlumac": "Aaron",
      "prezimeGlumac": "Stanford",
      "wikipediaStranicaGlumca": "Aaron_Stanford"
    },
    {
      "imeGlumac": "Amanda",
      "prezimeGlumac": "Schull",
      "wikipediaStranicaGlumca": "Amanda_Schull"
    },
    {
      "imeGlumac": "Noah",
      "prezimeGlumac": "Bean",
      "wikipediaStranicaGlumca": "Noah_Bean"
    }
  ],
  "wikipediaStranicaSerije": "12_Monkeys_(TV_series)",
  "brojSezona": 4,
  "godinaSnimanjaOdDo": "2015-2018",
  "infoSerije": "James Cole, vremenski putnik iz distopijske, bolescu poharane buducnosti, stize u sadasnjost s ocajnickim zadatkom da promijeni tijek povijesti. Inspirirano istoimenim hit filmom iz 1995. godine.",
  "urlPostera": "https://i.pinimg.com/originals/54/58/9c/54589c20f2ee47bb77092c2b3aea90ac.jpg"
},{
  "_id": {
    "$oid": "5f97108173c2c22ef41f44e9"
  },
  "nazivSerije": "Mr.Robot",
  "ocjenaIMDb": 8.6,
  "zanr": [
    "Drama",
    "Triler",
    "Misterij"
  ],
  "redatelj": {
    "imeRedatelj": "Sam",
    "prezimeRedatelj": "Esmail",
    "wikipediaStranicaRedatelja": "Sam_Esmail"
  },
  "glumci": [
    {
      "imeGlumac": "Rami",
      "prezimeGlumac": "Malek",
      "wikipediaStranicaGlumca": "Rami_Malek"
    },
    {
      "imeGlumac": "Cristian",
      "prezimeGlumac": "Slater",
      "wikipediaStranicaGlumca": "Christian_Slater"
    }
  ],
  "wikipediaStranicaSerije": "Mr._Robot",
  "brojSezona": 4,
  "godinaSnimanjaOdDo": "2015-2019",
  "infoSerije": "Dramska serija Mr. Robot prati Elliota Aldersona (Rami Malek), mladog inzenjera kibersigurnosti koji se spetlja s podzemnom hakerskom skupinom nakon sto ga regrutira njihov tajanstveni voda (Christian Slater).",
  "urlPostera": "https://images-na.ssl-images-amazon.com/images/I/A1fn0Ov4srL._AC_SL1500_.jpg"
},{
  "_id": {
    "$oid": "5f97108173c2c22ef41f44ea"
  },
  "nazivSerije": "Doctor Who",
  "ocjenaIMDb": 8.6,
  "zanr": [
    "Avantura",
    "Drama"
  ],
  "redatelj": {
    "imeRedatelj": "Sydney",
    "prezimeRedatelj": "Newman",
    "wikipediaStranicaRedatelja": "Sydney_Newman"
  },
  "glumci": [
    {
      "imeGlumac": "Jodie",
      "prezimeGlumac": "Whittaker",
      "wikipediaStranicaGlumca": "Jodie_Whittaker"
    },
    {
      "imeGlumac": "Peter",
      "prezimeGlumac": "Capaldi",
      "wikipediaStranicaGlumca": "Peter_Capaldi"
    },
    {
      "imeGlumac": "Pearl",
      "prezimeGlumac": "Mackie",
      "wikipediaStranicaGlumca": "Pearl_Mackie"
    }
  ],
  "wikipediaStranicaSerije": "Doctor_Who",
  "brojSezona": 12,
  "godinaSnimanjaOdDo": "2005-",
  "infoSerije": "Govori o pustolovinama tajanstvenog izvanzemaljca, poznatijeg kao Doktor, koji putuje kroz vrijeme i prostor u svom vremenskom stroju, TARDIS-u. Putujuci sa svojim mnogim suputnicima istrazuje svemir i vrijeme, rjesava probleme te se susrece s razlicitim cudovistima.",
  "urlPostera": "https://images-na.ssl-images-amazon.com/images/I/61e2LaUbu9L._AC_SL1024_.jpg"
},{
  "_id": {
    "$oid": "5f97108173c2c22ef41f44eb"
  },
  "nazivSerije": "Punisher",
  "ocjenaIMDb": 8.5,
  "zanr": [
    "Akcija",
    "Drama",
    "Krim"
  ],
  "redatelj": {
    "imeRedatelj": "Steve",
    "prezimeRedatelj": "Lightfoot",
    "wikipediaStranicaRedatelja": "Steve_Lightfoot"
  },
  "glumci": [
    {
      "imeGlumac": "Jon",
      "prezimeGlumac": "Bernthal",
      "wikipediaStranicaGlumca": "Jon_Bernthal"
    },
    {
      "imeGlumac": "Amber",
      "prezimeGlumac": "Rose Revah",
      "wikipediaStranicaGlumca": "Amber_Rose_Revah"
    }
  ],
  "wikipediaStranicaSerije": "The_Punisher_(TV_series)",
  "brojSezona": 2,
  "godinaSnimanjaOdDo": "2017-2019",
  "infoSerije": "Nakon sto mu zlocinac ubije cijelu obitelj bivsi vojnik krece u osvetnicku misiju",
  "urlPostera": "https://m.media-amazon.com/images/M/MV5BMTExODIwOTUxNzFeQTJeQWpwZ15BbWU4MDE5MDA0MTcz._V1_UX182_CR0,0,182,268_AL_.jpg"
},{
  "_id": {
    "$oid": "5f97108173c2c22ef41f44ec"
  },
  "nazivSerije": "Dark",
  "ocjenaIMDb": 8.8,
  "zanr": [
    "Krim",
    "Drama",
    "Misterij"
  ],
  "redatelj": {
    "imeRedatelj": "Baran",
    "prezimeRedatelj": "bo Odar",
    "wikipediaStranicaRedatelja": "Baran_bo_Odar"
  },
  "glumci": [
    {
      "imeGlumac": "Louis",
      "prezimeGlumac": "Hofmann",
      "wikipediaStranicaGlumca": "Louis_Hofmann"
    },
    {
      "imeGlumac": "Karoline",
      "prezimeGlumac": "Eichhorn",
      "wikipediaStranicaGlumca": "Karoline_Eichhorn"
    },
    {
      "imeGlumac": "Lisa",
      "prezimeGlumac": "Vicari",
      "wikipediaStranicaGlumca": "Lisa_Vicari"
    }
  ],
  "wikipediaStranicaSerije": "Dark_(TV_series)",
  "brojSezona": 3,
  "godinaSnimanjaOdDo": "2017-2020",
  "infoSerije": "Nakon nestanka djeteta, cetiri obitelji ocajnicki traze odgovore i rjesenje zagonetke koja obuhvaca tri generacije.",
  "urlPostera": "https://m.media-amazon.com/images/M/MV5BZmY2YzU4NDktODIxYi00YWIyLWIzYTctODBkYzYzZjc0ODdlXkEyXkFqcGdeQXVyMTEyMjM2NDc2._V1_UX182_CR0,0,182,268_AL_.jpg"
},{
  "_id": {
    "$oid": "5f97108173c2c22ef41f44ed"
  },
  "nazivSerije": "Modern Family",
  "ocjenaIMDb": 8.4,
  "zanr": [
    "Komedija",
    "Drama",
    "Romansa"
  ],
  "redatelj": {
    "imeRedatelj": "Steven",
    "prezimeRedatelj": "Levitan",
    "wikipediaStranicaRedatelja": "Steven_Levitan"
  },
  "glumci": [
    {
      "imeGlumac": "Ed",
      "prezimeGlumac": "O'Neill",
      "wikipediaStranicaGlumca": "Ed_O%27Neill"
    },
    {
      "imeGlumac": "Sof�a",
      "prezimeGlumac": "Vergara",
      "wikipediaStranicaGlumca": "Sof�a_Vergara"
    },
    {
      "imeGlumac": "Julie",
      "prezimeGlumac": "Bowen",
      "wikipediaStranicaGlumca": "Julie_Bowen"
    }
  ],
  "wikipediaStranicaSerije": "Modern_Family",
  "brojSezona": 11,
  "godinaSnimanjaOdDo": "2009-2020",
  "infoSerije": "Satiricni pogled na tri razlicite obitelji iz perspektive nevidljivog snimatelja dokumentaraca",
  "urlPostera": "https://m.media-amazon.com/images/M/MV5BNzRhNWIxYTEtYjc2NS00YWFlLWFhOGEtMDZiMWM1M2RkNDkyXkEyXkFqcGdeQXVyNjc0MjkzNjc@._V1_UX182_CR0,0,182,268_AL_.jpg"
},{
  "_id": {
    "$oid": "5f97108173c2c22ef41f44ee"
  },
  "nazivSerije": "13 Reasons Why",
  "ocjenaIMDb": 7.6,
  "zanr": [
    "Drama",
    "Misterij"
  ],
  "redatelj": {
    "imeRedatelj": "Brian",
    "prezimeRedatelj": "Yorkey",
    "wikipediaStranicaRedatelja": "Steven_Levitan"
  },
  "glumci": [
    {
      "imeGlumac": "Dylan",
      "prezimeGlumac": "Minnette",
      "wikipediaStranicaGlumca": "Dylan_Minnette"
    },
    {
      "imeGlumac": "Katherine",
      "prezimeGlumac": "Langford",
      "wikipediaStranicaGlumca": "Katherine_Langford"
    },
    {
      "imeGlumac": "Christian",
      "prezimeGlumac": "Navarro",
      "wikipediaStranicaGlumca": "Christian_Navarro"
    }
  ],
  "wikipediaStranicaSerije": "13_Reasons_Why",
  "brojSezona": 4,
  "godinaSnimanjaOdDo": "2017-2020",
  "infoSerije": "Nakon samoubojstva tinejdzerice Hanne njezini kolege iz skole dobiju seriju audio kaseta koje ce otkriti razloge njezinog tragicnog izbora. Prva sezona serije snimljena je prema istoimenom romanu Jaya Ashera dok su ostale sezone originalne price.",
  "urlPostera": "https://m.media-amazon.com/images/M/MV5BMDYzZTRlNGEtZDc2Mi00ZGNjLTlmZDAtMmVjMDZkOThiODEwXkEyXkFqcGdeQXVyMTkxNjUyNQ@@._V1_UX182_CR0,0,182,268_AL_.jpg"
},{
  "_id": {
    "$oid": "5f97108173c2c22ef41f44ef"
  },
  "nazivSerije": "Brooklyn Nine-Nine",
  "ocjenaIMDb": 8.4,
  "zanr": [
    "Komedija",
    "Krim"
  ],
  "redatelj": {
    "imeRedatelj": "Dan",
    "prezimeRedatelj": "Goor",
    "wikipediaStranicaRedatelja": "Dan_Goor"
  },
  "glumci": [
    {
      "imeGlumac": "Andy",
      "prezimeGlumac": "Samberg",
      "wikipediaStranicaGlumca": "Andy_Samberg"
    },
    {
      "imeGlumac": "Stephanie",
      "prezimeGlumac": "Beatriz",
      "wikipediaStranicaGlumca": "Stephanie_Beatriz"
    },
    {
      "imeGlumac": "Terry",
      "prezimeGlumac": "Crews",
      "wikipediaStranicaGlumca": "Terry_Crews"
    }
  ],
  "wikipediaStranicaSerije": "Brooklyn_Nine-Nine",
  "brojSezona": 7,
  "godinaSnimanjaOdDo": "2013-",
  "infoSerije": "Serija radnjom prati ekipu detektiva i novo im dodijeljenog policijskog kapetana",
  "urlPostera": "https://m.media-amazon.com/images/M/MV5BNzVkYWY4NzYtMWFlZi00YzkwLThhZDItZjcxYTU4ZTMzMDZmXkEyXkFqcGdeQXVyODUxOTU0OTg@._V1_UX182_CR0,0,182,268_AL_.jpg"
},{
  "_id": {
    "$oid": "5f97108173c2c22ef41f44f0"
  },
  "nazivSerije": "The Big Bang Theory",
  "ocjenaIMDb": 8.1,
  "zanr": [
    "Komedija",
    "Romansa"
  ],
  "redatelj": {
    "imeRedatelj": "Mark",
    "prezimeRedatelj": "Cendrowski",
    "wikipediaStranicaRedatelja": "Mark_Cendrowski"
  },
  "glumci": [
    {
      "imeGlumac": "Johnny",
      "prezimeGlumac": "Galecki",
      "wikipediaStranicaGlumca": "Johnny_Galecki"
    },
    {
      "imeGlumac": "Jim",
      "prezimeGlumac": "Parsons",
      "wikipediaStranicaGlumca": "Jim_Parsons"
    },
    {
      "imeGlumac": "Kaley",
      "prezimeGlumac": "Cuoco",
      "wikipediaStranicaGlumca": "Kaley_Cuoco"
    }
  ],
  "wikipediaStranicaSerije": "The_Big_Bang_Theory",
  "brojSezona": 12,
  "godinaSnimanjaOdDo": "2007-2019",
  "infoSerije": "Serija radnjom prati ekipu znanstvenika",
  "urlPostera": "https://m.media-amazon.com/images/M/MV5BY2FmZTY5YTktOWRlYy00NmIyLWE0ZmQtZDg2YjlmMzczZDZiXkEyXkFqcGdeQXVyNjg4NzAyOTA@._V1_UX182_CR0,0,182,268_AL_.jpg"
},{
  "_id": {
    "$oid": "5f97108173c2c22ef41f44f1"
  },
  "nazivSerije": "CSI:Miami",
  "ocjenaIMDb": 6.4,
  "zanr": [
    "Akcija",
    "Drama",
    "Krim"
  ],
  "redatelj": {
    "imeRedatelj": "Joe", 
    "prezimeRedatelj": "Chappelle",
    "wikipediaStranicaRedatelja": "Joe_Chappelle"
  },
  "glumci": [
    {
      "imeGlumac": "David",
      "prezimeGlumac":"Caruso",
      "wikipediaStranicaGlumca": "David_Caruso"
    },
    {
      "imeGlumac": "Emily",
      "prezimeGlumac":"Procter",
      "wikipediaStranicaGlumca": "Emily_Procter"
    }
  ],
  "wikipediaStranicaSerije": "CSI:_Miami",
  "brojSezona": 10,
  "godinaSnimanjaOdDo": "2002-2012",
  "infoSerije": "CSI: Miami prati slucajeve juznofloridskog tima istrazitelja koji, koristeci se posljednjim detektivsko-znanstvenim, ali i onim klasicnim policijskim metodama, rjesava najbizarnije i najkompliciranije zlocine",
  "urlPostera": "m.media-amazon.com/images/M/MV5BOTU3ZTI5ZGEtYjhiMy00ODU4LTgyM2UtNDhlYjBhMjc4MjIwXkEyXkFqcGdeQXVyMTYzMDM0NTU@._V1_UY268_CR0,0,182,268_AL_.jpg"
}];

$(document).ready(function(){

function getValues(obj, key) {
    var objects = [];
    for (var i in obj) {
        if (!obj.hasOwnProperty(i)) continue;
        if (typeof obj[i] == 'object') {
				objects = objects.concat(getValues(obj[i], key));
        } else if (i == key) {
            objects.push(obj[i]);
        }
	}
	console.log(objects)
    return objects;
}

//return an array of keys that match on a certain value
function getKeys(obj, val) {
    var objects = [];
    for (var i in obj) {
        if (!obj.hasOwnProperty(i)) continue;
        if (typeof obj[i] == 'object') {
            objects = objects.concat(getKeys(obj[i], val));
        } else if (obj[i] == val) {
            objects.push(i);
        }
    }
    return objects;
}

$('#wild').click(function() {
	var p = ['imeGlumac', 'prezimeGlumac', 'imeRedatelj', 'prezimeRedatelj', 'nazivSerije'];
		filtriraj(p)
		
		});
		 $('#imeGlumac').click(function() {
			var p = ['imeGlumac']
			filtriraj(p)
		});
		$('#prezimeGlumac').click(function() {
			var p = ['prezimeGlumac']
			filtriraj(p)
		});
		$('#imeRedatelj').click(function() {
			
			var p = ['imeRedatelj']
			filtriraj(p)
		});
		 $('#prezimeRedatelj').click(function() {
			
			var p = ['prezimeRedatelj']
			filtriraj(p)
		});
		$('#nazivSerije').click(function() {
			
			var p = ['nazivSerije']
			filtriraj(p)
		});
    // here and only here you can access the results of your AJAX call.
   
function filtriraj(v) {
	var d;
	var j;
	var rez = [];
	var n = v.length
		for(var i = 0; i < n; i++){
			console.log(i)
			console.log(v[i])
			j = getValues(data, v[i]);
			rez = rez.concat(j);		
		}
	
		d = rez;
$('#txt-search').keyup(function(){
            var searchField = $(this).val();
			if(searchField === '')  {
				$('#filter-records').html('');
				return;
			}
			
            var regex = new RegExp(searchField, "i");
            var output = '<div class="row">';
			var count = 1;

			  var val = $.each(d, function(key, val){
				if ((val.search(regex) != -1)) {
					var k = getKeys(data, val);
				  output += '<div class="col-md-6 well">';
				  output += '<div class="col-md-7">';
					output += '<h5>' + k + '</h5>' + '<h4>' + '<b>' + val + '</b>' + '<h4>';
				  output += '</div>';
				  output += '</div>';
				  output += '</div><div class="row">'
				  count++;
				  return val;
				}
			  });
			  output += '</div>';
			  console.log(val)
			  $('#filter-records').html(output);
		});
}
  });
  $('#downloadAnchorElem').click(function() {
			var dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(data));
			var dlAnchorElem = document.getElementById('downloadAnchorElem');
			dlAnchorElem.setAttribute("href",     dataStr     );
			dlAnchorElem.setAttribute("download", "scene.json");
			dlAnchorElem.click();
			});

			
function myFunction() {
  document.getElementById("myDropdown").classList.toggle("show");
}
function myFunction2() {
  document.getElementById("myDropdown2").classList.toggle("show");
}
function myFunction3() {
  document.getElementById("myDropdown3").classList.toggle("show");
}


window.onclick = function(event) {
  if (!event.target.matches('.dropbtn')) {
    var dropdowns = document.getElementsByClassName("dropdown-content");
    var i;
    for (i = 0; i < dropdowns.length; i++) {
      var openDropdown = dropdowns[i];
      if (openDropdown.classList.contains('show')) {
        openDropdown.classList.remove('show');
      }
    }
  }
}
</script>
